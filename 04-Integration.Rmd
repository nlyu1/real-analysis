# Integration on $\R^n$ {#realIntegration}

This section explores measurable functions and Lebesgue 
integration on $\R^n$. 
 
1. [Measurable functions](#functionMeasurabilityConditions) on $\R^n$: 
    approximation by simple functions, conditions for measurability, 
    limit of measurable functions. 
    - Axler, chapter 3. 
2. [Littlewood's three principles](#littlewoodPrinciples): 
    Egorov and Luzin's theorems. 
    - Axler, chapter 3. 
3. [Lebesgue integration](#lebesgueConvergence): definition 
    of Lebesgue integration, dominated convergence theorem, 
    and comparison with Riemann integral. 
    - Rudin, chapter 11. 
4. [Iterated integrals](#iteratedIntegrals). 
    - Lieb and Loss, chapter 2; Axler, chapter 5. 

Key takeaways: 

1. Placeholder. 

## Measurable functions on $\R^n$ {#functionMeasurabilityConditions -}

### Simple functions {-}

:::{.definition name="characteristic function"}
Given $E\subset \Omega$, the characteristic function $\chi_E:\Omega\to \R$ is 
\[ 
    \chi_E(x) = \begin{cases}
        1 & x\in E \\ 
        0 & x\notin E
    \end{cases}
\] 
:::

:::{.proposition}
Given $(\Omega, \Sigma), E\subset \Omega$, then 
$\chi_E$ is $\Sigma$-measurable iff $E\in \Sigma$. 
:::
_Proof:_ 
$\chi_E^{-1}(B) = \{E, \Omega-E, \Omega, \emptyset\}$ 
depending on how $B\subset \R$ intersects with $\{0, 1\}$. 

:::{.definition name="simple function"}
A simple function is a finite sum 
\[ 
    f = \sum_{k=1}^N a_k \chi_{E_k} 
\] 
where each $E_k$ is a finite-measurable set. 
:::

The following proof is from Ch. 11 of [@rudin1964principles]. 

:::{.theorem #simpleFunctionApproximation name="simple-function approximation"}
Given a real function $f:\Omega\to \R$, there exists a sequence 
$\{s_n\}$ of simple functions such that $s_n(x)\to f(x)$ 
point-wise. If $f$ is measurable, then $\{s_n\}$ 
may be chosen to be a sequence of measurable functions. 
If $f\geq 0$, then $\{s_n\}$ may be chosen to be a monotonically 
increasing sequence. 
:::
_Proof:_ Given $f\geq 0$, define $F_n = f^{-1}([n, \infty))$ and 
\[ 
    E_{n, i} = f^{-1} \left(\left[2^{-n}(i-1), 2^{-n}i \right]\right)
\] 
For $n=1, 2, \cdots$ and $i=1, 2, \cdots, n2^n$, choose 
\[ 
    s_n = n\chi_{F_n} + \sum_{i=1}^{n2^n} \df{i-1}{2^n} \chi_{E_{n, i}}
\] 
Note that $E_{n, i}$ is the pre-image of the $i$-th slice of 
nonnegative real blocks of size $2^{-n}$, and the first term assigns 
$\inf f=2^{-n}(i-1)$ on the corresponding intervals. The second 
term just assigns approximates with $n$ all places where $f(x)\geq n$. 
The second term is reserved for cases where $f(x)=\infty$. In short: 

1. In the $n$-th approximation, approximate $f$ up to value $n$. 
2. Divide $f^{-1}([0, n])$ into $2^{-n}$ pieces and assign a dominated 
    simple function. Approximate the rest simply with $n$. 

If $f$ is measurable, the domains of the characteristic decomposition 
are measurable so $s_n$ is measurable. The general case follows by 
$f=f^+-f^-$. 

### Conditions for measurability {-}

:::{.example}
If $\Sigma=\{\emptyset, \Omega\}$, then the only $\Sigma$-measurable 
functions from $\Omega\to \R^n$ are constant functions. On the 
other extreme, if $\Sigma=2^\Omega$, then every function is measurable. 
For a nontrivial example, if $\Sigma=\{\emptyset, (-\infty, 0), [0, \infty), \R\}$ 
then $f:\R\to \R$ is measurable iff it is 
constant on $(-\infty, 0), [0, \infty)$. 
:::

:::{.proposition name="continuity implies Borel measurability"}
Every continuous function $f:\Omega\to \R^n$ defined on 
a Borel subset $\Omega\subset \R^m$ is a Borel-measurable function. 
:::
_Proof:_ Consider the preimage of $x>a$ ($x, a\in \R^n$ and inequality 
holds elementwise). For any such $a$, consider 
\[ 
    f^{-1}(x>a) 
    = \left[\bigcup_{x\in f^{-1}(x>a)} (x-\delta_x, x+\delta_x) \right]\cap \Omega
\] 
Given every $x\in \R^m: f(x)>a$, by continuity $\exists \delta_x\in \R$ 
such that $f((x-\delta_x, x+\delta_x))>a$. The term in the paranthesis 
is an open set, hence its intersection with the Borel set $\Omega$ is Borel. 

$f:(\Omega\subset \R)\to \R$ is increasing if $x < y\implies f(x)\leq f(y)$; 
it is monotonic if $f$ or $-f$ is increasing. 

:::{.proposition}
if $f:\Omega\to \R$ is monotonic and $\Omega$ is Borel, then $f$ is measurable. 
:::
_Proof:_ Fix $a\in \R$, then for $b=\inf f^{-1}((a, \infty))$, 
monotonicity implies 
\[ 
    f^{-1}((a, \infty)) = (b, \infty)\cap \Omega 
    \text{ or }
    [b, \infty)\cap \Omega
\] 

:::{.proposition name="preservation of measurability under limits"}
Suppose $\{f_j\}\to f:(\Omega, \Sigma)\to \R^n$ point-wise each $f_j$ 
is $\Sigma$-measurable, then $f$ is $\Sigma$-measurable. 
:::
_Proof:_ Unrolling the definition of the limit: for any 
$x\in \Omega, a\in \R^n$, $f(x)>a$ iff 
\begin{align}
    & \lim_{k\to \infty} f_k(x) > a \\ 
    \iff & \exists j>0, \exists N: f_{\forall k>N}(x)>a+1/j \\ 
    \iff & x\in \bigcup_{j=1}^\infty 
        \bigcup_{N=1}^\infty 
        \bigcap_{k=1}^\infty f_k^{-1}(y>a+1/j)
\end{align}
Note that we only need some $j$ to exist. Each $\exists$ translates 
to $\bigcup$, and each $\forall$ translates to $\bigcap$. Then 
the preimage of $y>a$ the measurable set above. 

:::{.definition name="extended Borel"}
$A\subset [-\infty \infty]$ is a Borel set if $A\cap \R$ is Borel. 
Extended measurability is defined similarly. 
:::

:::{.theorem name="variational limits are measurable"}
Given measurable $\{f_k: (\Omega, \Sigma)\to \R\}$, the following functions 
are also measurable: 
\[ 
    g(x) = \inf_k f_k(x), \quad h(x) = \sup_k f_k(x)
\] 
:::
_Proof:_ It suffices to verify for the $\sup$ case that 
\begin{align}
    h(x) > a &\implies \exists k: f_k(x) > a \\ 
    h^{-1}((a, \infty]) &= \bigcup_{k=1}^\infty f_k^{-1}((a, \infty])
\end{align} 

:::{.proposition name="a.e. measurability"}
Given $f$ measurable and $f=g$ a.e. (they differ on a set of 
measure $0$ on the domain), then $g$ is measurable. 
:::
_Proof:_ Let $\{\mca A\}$ be a subbasis generating the measurable  
sets, then $\forall A\in \mca A$, the symmetric difference of 
pre-images $f^{-1}(A), g^{-1}(A)$ is dominated by a set of 
measure $0$; by measurability $g^{-1}(A)$ is measurable, 
so $f^{-1}(S)$ is also measurable. 

Some notations are convenient: 

:::{.definition #setSequenceNotation name="sequence of sets"}
An increasing sequence of sets $\{A_n\}$ is a sequence 
\[ 
    A_1\subset A_2\subset \cdots \to A = \bigcup_{n=1}^\infty A_n
\] 
also written $A_j\nearrow A$. Similarly, a decreasing 
sequence of sets is written $A_j\searrow A$. 
\[ 
    A_1\supset A_2\supset \cdots \to A = \bigcap_{n=1}^\infty A_n 
\] 
:::

## Littlewood's three principles {#littlewoodPrinciples -}

Littlewood's three principles are: 

1. Every finite-measurable set is almost a finite union of intervals. 
2. Every measurable function is almost continuous. 
3. Every pointwise convergent sequence of measurable functions 
    is almost uniformly convergent. 

To be precise, the third principle is formulated as follows: 

:::{.theorem name="Egorov's theorem"}
Given a a measurable sequence $(f_k)$ on a finite-measurable set 
$E$ with $\mu(E)<\infty$ such that $f_k\to f$ a.e. on $E$. 
For every $\epsilon>0$, there exists a closed set $A_\epsilon \subset E$ 
such that $\mu(E-A_\epsilon)<\epsilon$ and $f_k\to f$ uniformly 
on $A_\epsilon$ 
:::
_Proof:_ without loss of generality assume $f_k\to f$ pointwise (not just 
pointwise a.e.) since we only require $\mu(E-A_\epsilon)<\epsilon$; 
for each $n, k$, define 
\[ 
    E_k^n = \{x\in E: |f_{\forall j>k}(x) - f(x)|<1/n\}
\] 
In other words, this is the set on which $f_{j>k}$ is 
$1/n$-close to $f$ on $E$. Fix $n$. Note that 
$E^n_k\nearrow E$ by $f_k\to f$ (recall definition 
\@ref(def:setSequenceNotation)); then there exists $k_n$ 
such that 
\[ 
    \mu(E - E^n_{k_n}) < 2^{-n}, \quad 
    \sup_{x\in E^n_{k_n}} |f_j(x) - f(x)| < 1/n 
\] 
Choose $N$ so that $\sum_{n=N}^\infty 2^{-n}<\epsilon/2$ and let 
\[ 
    \tilde A_\epsilon = \bigcap_{n\geq N} E^n_{k_n}
\] 
This is domain subset on which, for each $n\geq N$, 
$|f_{j\geq k_n}(x) - f(x)| \leq 1/N$; also note that 
\[ 
    \mu(E - \tilde A_\epsilon) \leq \sum_{n=N}^\infty \mu(E - E^n_{k_n}) 
    < \epsilon/2 
\] 
Also note that $\tilde A_\epsilon$ is measurable since it is the 
intersection of $E^n_k$ which are pre-images; then by measurability 
characterization \@ref(thm:measurableCharacterization) there exists a 
closed $\epsilon/4$-coveree $A_\epsilon$ of $\tilde A_\epsilon$. 
Moreover, $f_k\to f$ uniformly on $A_\epsilon$ since for every 
$0<\epsilon'<1/n$, $|f_j(x)-f(x)|<\epsilon'$ when $j>k_n$ and 
$x\in E^n_{k_n} \supset A_\epsilon$. 

Similarly, the precise statement of the second principle is: 

:::{.theorem name="Lusin's theorem"}
Given measurable $f$ finite-valued on $E$ and $\mu(E)<\infty$, then 
for every $\epsilon>0$ there exists a closed $\epsilon$-coveree 
$F_\epsilon \subset E$ with $\mu(E-F_\epsilon)<\epsilon$ such that 
$f_{|F_\epsilon}$ is continuous in the subspace topology. 
:::
_Proof:_ <span style="color:red"> TODO </span>

<span style="color:green">
Lusin's theorem _does not claim_ that $f$ is continuous on $F_\epsilon$, 
only that $f_{|F_\epsilon}$ is continuous in the subspace topology. 
</span>

## Lebesgue integration {#lebesgueIntegration -}

:::{.definition name="function support"}
The support of a measurable function $f$ is 
\[ 
    \supp(f) = \overline{f^{-1}(\{0\}^C)}
\] 
the closure of domain on which $f$ does not vanish. 
:::

:::{.definition name="S-partition"}
Given a $\sigma$-algebra $\Sigma$ on set $\Omega$, an 
$\Sigma$-partition of $\Omega$ is a finite collection 
$A_1, \cdots, A_m$ of disjoint sets in $\Sigma$ 
such that $\bigsqcup A_j = \Omega$. 
:::

:::{.definition name="lower Lebesgue sum"}
Given measure space $(\Omega, \Sigma, \mu)$, 
an $\Sigma$-measurable function $f:\Omega\to [0, \infty]$, 
and a $\Sigma$-partition $P=\{A_1, \cdots, A_m\}$ of $\Omega$, 
the lower Lebesgue sum is 
\[ 
    \mca L_\mu(f, P) = \sum_{j=1}^m \mu(A_j)\inf_{A_j} f 
\] 
:::

:::{.definition #nonNegativeIntegral name="non-negative integral"}
The integral of a non-negative function $f:\Omega\to [0, \infty]$ 
w.r.t. the measure $(\Sigma, \mu)$ is 
\[ 
    \int f\, d\mu = \sup_P \mca L_\mu(f, P)
\] 
where $P$ is taken over all $\Sigma$-partition of $\Omega$. 
:::

:::{.proposition name="integral of characteristic function"}
Given $\Omega, \Sigma, \mu)$ and $E\in \Sigma$, 
$\int \chi_E\, d\mu = \mu(E)$. 
:::
_Proof_ we have $\mca L_\mu(\chi_E, \{E, \Omega-E\}) = \mu(E)$, then 
$\int f\, d\mu \geq \mu(E)$. Conversely, given any $\Sigma$-partition 
$P=\{A_1, \cdots, A_m\}$ of $\Omega$, for each $j$ 
\[ 
    \mu(A_j) \inf_{A_j} \chi_E = \begin{cases}
        \mu(A_j) & A_j\subset E \\ 
        0 & \text{otherwise}
    \end{cases}
\] 
then 
$\mca L(\chi_E, P) = \sum_{A_j\subset E} \mu(A_j) \leq \mu(E)$. 

:::{.proposition name="integral of a simple function"}
Given a measure space $(\Omega, \Sigma, \mu)$ and disjoint
$E_1, \cdots E_n$, we have 
\[ 
    \int \left(\sum_{k=1}^n c_k \chi_{E_k}\right)\, d\mu 
    = \sum_{k=1}^n c_k \mu(E_k)
\] 
:::
_Proof:_ The LHS integral is lower-bounded by the $\Sigma$-partition 
$\{E_j\}\cup \{\Omega-\bigcup E_j\}$. The converse follows similar 
to the last proposition. 

In light of the previous proposition, we have 

:::{.corollary name="equivalent definition of nonnegative integral"}
Given $(\Omega, \Sigma, \mu)$ and measurable $f:\Omega\to [0, \infty]$, 
the integral definition \@ref(def:nonNegativeIntegral) is equivalent to 
\[ 
    \int f\, d\mu = \sup_P \mca L_\mu(f, P) = \sup_s \int s\, d\mu 
\] 
where the last $\sup$ is taken over all simple function $f$ dominated 
by $f$: $\forall x\in \Omega: f(x)\geq s(x)$. 
:::
_Proof:_ Simply follows from $\mca L_\mu(f, P)$ being 
the integral of a simple function. 

:::{.definition name="general real integral"}
Given $(\Omega, \Sigma, \mu)$ and measurable $f:[-\infty, \infty]$ 
such that _at least one_ of $\int f^+\, d\mu, \int f^-\, d\mu$ 
is finite; the integral of $f$ w.r.t. $\mu$ is 
\[ 
    \int f\, d\mu = \int f^+\, d\mu - \int f^-\, d\mu 
\] 
:::

Note that the integral of the following function is not defined: 
\[ 
    f(x) = \begin{cases}
        1 & x\geq 0 \\ -1 & x < 0
    \end{cases}
\] 

:::{.definition name="integral metric, integrable space"}
Fix $(\Omega, \Sigma, \mu)$; if $f:\Omega\to [-\infty, \infty]$ 
is measurable, then the $L^1$-norm of $f$ is 
\[  
    \|f_1\| = \int |f|\, d\mu 
\] 
The Lebesgue space $L^1(\mu)$ is also 
\[  
    L^1(\mu) = \{f:\Omega\to \R | \|f\|_1 < \infty \}
\] 
:::

:::{.theorem name="properties of integration"}
The following properties are evident for $f, g\in L^1(\mu)$: 

1. _Linearity:_ $\int cf+g\, d\mu = c\int f\, d\mu + \int g\, d\mu$. 
2. _Order-preserving_: $f\leq g\implies \int f\, d\mu \leq \int g\, d\mu$. 
3. _Metric subadditivity_: 
    $\left|\int f\, d\mu\right| \leq \int |f|\, d\mu$. 
:::

_Proof:_ General idea is to establish for simple functions, then 
show that the proof commutes with integral construction. 
For (2), use $\int g\, d\mu - \int f\, d\mu = \int (g-f)\, d\mu$. 
For (3), 
\begin{align}
    \left|\int f\, d\mu\right| 
    &= \left| \int f^+\, d\mu - \int f^-\, d\mu\right| 
    \leq \int f^+\, d\mu + \int f^-\, d\mu \\ 
    &= \int (f^++f^-)\, d\mu 
    = \int |f|\, d\mu 
\end{align}

:::{.definition name="integration on subset"}
Given $(\Omega, \Sigma, \mu)$ and $E\in \Sigma$ and 
measurable $f:\Omega\to [-\infty, \infty]$, the subset integral is 
\[ 
    \int_E f\, d\mu = \int \chi_E f\, d\mu 
\] 
:::

:::{.proposition #integralBound name="integral bound"}
Given $\int_E f\, d\mu < \infty$, 
\[ 
    \left|\int_E f\, d\mu \right| \leq \mu(E) \sup_E |f|
\] 
:::
_Proof:_ let $c=\sup_E |f|$, then 
\[ 
    \left|\int_E f\, d\mu\right| \leq \int \chi_E |f|\, d\mu 
    \leq \int c\chi_E \, d\mu = c\mu(E)
\] 

:::{.theorem #domainIntegralAdditivity name="disjoint additivity w.r.t domain"}
Given measurable $f$, define the function 
$\phi:\Sigma\to [-\infty, \infty]$ by 
\[ 
    \phi(A) = \int_A f\, d\mu 
\] 
then for every $A, B\in \Sigma$, we have 
$\phi(A\sqcup B) = \phi(A)+\phi(B)$. 
:::
_Proof:_ without loss of generality consider nonnegative $f$. 
If $f$ is a characteristic function, then countable additivity 
is equivalent to the countable subadditivity of $\mu$. 
The general proof just demonstrates the commutativity of 
countable subadditivity with the $\sup$ integral construction. 

:::{.corollary name="sets of zero measure are negligible in integration"}
Given 
$A, B\in \Sigma$ such that $\mu(A-B)=0$, then 
\[ 
    \int_A f\, d\mu = \int_B f\, d\mu 
\] 
:::
_Proof:_ Follows from additivity theorem 
\@ref(thm:domainIntegralAdditivity) and applying $\mu(A-B)=0$ 
to proposition \@ref(prp:integralBound). 

The integrability of $f$ implies that of $|f|$, and the 
Lebesgue integral is often called an absolutely convergent integral. 

:::{.proposition name="several conditions for integrability"}

1. $f\in L^1(\mu)\implies |f|\in L^1(\mu)$. 
2. $f$ is measurable and $|f|\leq g \in L^1(\mu)\implies f\in L^1(\mu)$. 
:::
_Proof:_ for (1), recall that $f\in L^1(\mu)$ if both $f^+, f^-$ 
have finite integrals, then $|f|=f^++f^-$ is integrable. 
Similarly, (2) follows from $f^+, f^-\leq g$. 

## Convergence theorems {#lebesgueConvergence -}

The following convergence theorems are the cornerstone of 
Lebesgue theory: 

:::{.theorem #monotoneConvergence name="Lebesgue's monotone convergence theorem"}
Given $E$ measurable, let $\{f_n\}$ be a sequence of 
measurable functions such that $0\leq f_1\leq \cdots$ on $E$
and $f_n\to f$, then 
\[ 
    \int_E f_n \, d\mu \to \int_E f\, d\mu 
\] 
Pointwise monotone convergence of measurable functions 
on a measurable set implies convergence of integral. 
:::
_Proof:_ One direction is trivial; the other is established by 
first proving for a dominated simple lower approximation of $f$ 
then taking the $\sup$. 

Let $F_n = \int_E f_n\, d\mu$. It is 
clear that $F_n\to F\in (-\infty, \infty]$. We also have 
\[ 
    f_n \leq f\implies \lim_{n\to \infty} F_n 
    = F \leq \int_E f\, d\mu 
\] 
To establish the other direction， fix $c\in (0, 1)$ 
and simple function $s\leq f$. Define 
\[ 
    E_n = \{x| f_n \geq c s\} 
\] 
note that $E_j \nearrow E$ (recall notation \@ref(def:setSequenceNotation)) 
and, for every $n$ 
\[  
    F_n = \int_E f_n \, d\mu \geq \int_{E_n} f_n\, d\mu 
    \geq c\int_{E_n} s\, d\mu 
\] 
Let $n\to \infty$ and notice that the last integral is disjoint-additive 
on the domain argument $E_n$ by theorem \@ref(thm:domainIntegralAdditivity); 
let $c\to 1$ to obtain 
\[ 
    F \geq \int E_s\, d\mu c\int_E s\, d\mu 
\] 
Take the $\sup$ over all $s$ and the simple function approximation 
theorem \@ref(thm:simpleFunctionApproximation) to obtain 
$F\geq \int_E f\, d\mu$. 

Applying the monotone convergence theorem above to 
partial sums yield 

:::{.corollary}
Given measurable $E\in \Sigma$ and nonnegative measurable sequence 
$(f_j)$; define their sum 
\[ 
    f = \sum_{n=1}^\infty f_n 
\] 
then $\int_E f = \sum_{n=1}^\infty \int_E f_n\, d\mu$. 
:::

:::{.theorem name="Fatou's theorem"}
For measurable $E$, given nonnegative measurable 
sequence $(f_j)$ and 
\[ 
    f(x) = \liminf_{n\to \infty} f_n(x) 
\] 
then the integral is similarly bounded 
\[ 
    \int_E f\, d\mu \leq \liminf_{n\to \infty} \int_E f_n\, d\mu 
\] 
:::
_Proof:_ Define $g_n = \inf_{i\geq n} f_i$, then $g_n$ is 
measurable and 
\[ 
    i\leq j\implies g_i\leq g_j, \quad g_n\to f 
\] 
Applying the monotone convergence theorem yields 
\[ 
    \int_E g_n\, d\mu \to \int_E f\, d\mu 
\] 
<span style="color:green">
Note that this _does not_ imply equality because the 
monotone convergence theorem above only implies 
\[ 
    \int_E f\, d\mu 
    = \lim_{n\to \infty} \int_E \inf_{k\geq n} f_k\, d\mu 
    \not \implies 
    \int_E f\, d\mu 
    = \lim_{n\to \infty} \inf_{k\geq n} \int_E f_k\, d\mu 
\] 
In the presence of the limit, we can only establish LHS $\leq$ RHS: 
there may be cases where measure is lost through $\inf f_k$ 
but not through the $\inf$ of the measure. 
</span>

:::{.remark name="strict inequality in Fatou's theorem"}
Let $g(x) = (0\leq x\leq 1/2)^?0:1$ and 
\[ 
    f_{2k}(x) = g(x), \quad f_{2k+1} = g(1-x)
\] 
then $\liminf_{n\to \infty} f_n = 0$ but 
$\forall n, \int_0^1 f_n(x)\, dx = 1/2$. 
:::

:::{.theorem #dominatedConvergence name="Lebesgue's dominated convergence theorem"}
Given measurable sequence $(f_j)\to f$ pointwise and 
$|f_j| \leq g$ with $g$ measurable, then 
\[ 
    \lim_{n\to \infty} \int_E f_n\, d\mu = \int_E f\, d\mu 
\] 
As a corollary, $L^1$ is complete under dominated 
pointwise convergence. 
:::
_Proof:_ First note that $f_j, f$ are integrable since 
they're dominated by $g$. By $f_n+g\geq 0$, 
invoke Fatou's theorem 
\[ 
    \int_E (f + g)\, d\mu \leq 
    \liminf_{n\to \infty} \int_E (f_n+g)\, d\mu 
    \implies \int_E f\, d\mu \leq \liminf_{n\to \infty} \int_E f_n\, d\mu 
\] 
and pull $g$ out of both sides. Again, by $g-f_n\geq 0$ see 
\begin{align}
    \int_E (g - f)\, d\mu &\leq 
    \liminf_{n\to \infty} \int_E (g - f_n)\, d\mu \\ 
    -\int_E f\, d\mu &\leq 
    \liminf_{n\to \infty} \int_E -f_n\, d\mu 
    =-\limsup_{n\to \infty} \int_E f_n\, d\mu 
\end{align}
Combine the two results to obtain equality 
\[ 
    \limsup_{n\to \infty} \int_E f_n\, d\mu 
    \leq \int_E f\, d\mu \leq 
    \liminf_{n\to \infty} \int_E f_n\, d\mu 
\] 

:::{.corollary name="bounded convergence theorem"}
Given finite-measurable $\mu(E) < \infty$ and uniformly bounded 
convergent sequence $(f_n)\to f$ (i.e. $|f_n(x)|\leq M$ for all $n, x$), 
the dominated convergence theorem applies. 
:::
_Proof:_ Given finite measure $\mu(E)<\infty$, the 
constant-$M$ function is integrable and dominates $(f_n)$. 


### Comparison with Riemann integral {-}

Denote the Riemann integral by $\mca R\int_a^b f\, dx$. 

:::{.theorem name="compatibility with Riemann integral"}
Given Riemann integrable $f$ on $[a, b]$, then $f\in L^1([a, b])$ and 
\[ 
    \int_a^b f\, dx = \mca R \int_a^b f\, dx 
\] 
:::
_Proof:_ By existence of the Riemann integral, there 
exists a countable sequence of iteratively refined partitions $P_k$ 
such that 
\[ 
    \lim_{k\to \infty} L(P_k, f) = \mca R \underline{\int} f\, dx, \quad 
    \lim_{k\to \infty} U(P_k, f) = \mca R \bar \int f\, dx 
\] 
For each partition $P_k$, define functions $U_k(x\in [x_{j-1}, x_j])$ and 
$L_k$ to be the sup and inf along the interval, respectively, then 
in the Lebesgue sense, 
\[ 
    L(P_k, f) = \int L_k\, dx, \quad U(P_k, f) = \int U_k\, dx 
\] 
the functions are also monotone 
$L_1 \leq L_2 \leq \cdots \leq f \leq \cdots \leq U_1$. 
Let $L_k\to L, U_k\to U$, then $L, U$ are bounded measurable functions 
with $L\leq f\leq U$. Then 
\[ 
    \int L\, dx = \mca R \underline \int f\, dx, \quad 
    \int U\, dx = \mca R \bar \int f\, dx 
\] 
by the monotone convergence theorem. Further note that $f$ is 
Riemann-integrable iff $\int L\, dx = \int U\, dx$. 
This implies $L=U$ a.e. since $L\leq U$, then $L=f=U$ a.e. and $f$ 
is measurable; equality with Lebesgue integral follows. 

:::{.theorem name="Riemann integrability theorem"}
Given $f$ bounded on $[a, b]$, then the Riemann integral $\mca R\int_a^b f\, dx$ 
exists iff $f$ is continuous a.e. on $[a, b]$. 
:::
_Proof:_ Extending the last proof: 
for any $x\notin P_k$ for any $k$, we have $U(x)=L(x)$ iff $f$ 
is continuous at $x$ (think about this! equivalent to saying that 
$\sup\approx \inf$ arbitrarily close intervals about $x$); the union 
$\bigcup P_k$ is countable of measure $0$, then $f$ is continuous a.e. 
iff $L=U$ a.e. iff $f$ is Riemann-integrable on $[a, b]$. 