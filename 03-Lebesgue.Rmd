# Lebesgue measure {#realMeasures}

This section establishes the base case of the Lebesgue 
measure on $\R^n$: 

1. [Exterior measure](#extMeasure): foundational properties of the exterior 
    measure and interaction with rectangles. 
2. [Lebesgue measure and Borel regularity](#lebMeasure): 
    Borel sets, example of a non-measurable set, and approximation characterizations 
    of measurable sets. 

Key takeaways: 

1. The exterior measure is the natural outer-measure extension of rectangle volume that 
    satisfies _monotonicity_ and _countable subadditivity_. 
2. The Lebesgue measure is the Carathéodory restriction of the exterior measure. 
3. Rectangles are measurable (proposition \@ref(prp:rectangleMeasurable)), 
        so Borel sets are measurable since they 
        are freely-generated by rectangles. 
4. The exterior measure (rectangle cover infimum) 
    is equivalent to open cover infimum, and on measurable sets equivalent 
    to compact subset supremum. 
5. A set is measurable iff 
    - it can be upper-approximated by an open cover 
    or lower-approximated by a closed subset up to arbitrarily small but 
    finite measure \@ref(thm:squeezeMeasurable). 
    - it can be approximated by a Borel set up 
    to zero measure \@ref(thm:borelApprox). 
    - it differs from a measurable set by zero 
    measure \@ref(prp:nullDifferenceMeasurability). 

## Rectangles, exterior measure {#extMeasure -}

:::{.definition name="exterior measure"}
The exterior measure $\mu_*(E)$ of any subset $E\subset \R^n$ is 
\[ 
    \mu_*(E) = \inf \sum_{j=1}^\infty |R_j|
\] 
where the $\inf$ is over all countable coverings of $E$ by 
closed rectangles, the measure of a closed rectangle 
$R_j = \prod_{j=1}^n [a_j, b_j]$ is $|Q_j| = \prod_{j=1}^n (b_j - a_j)$. 
:::

:::{.proposition #extOuterMeasure}
The exterior is an outer measure per definition \@ref(def:defOuterMeasure). 

- $E_1\subset E_2\implies \mu_*(E_1)\leq \mu_*(E_2)$. 
- $E=\bigcup_{j=1}^\infty E_j\implies \mu_*(E)\leq \sum_{j=1}^\infty \mu_*(E_j)$. 
:::
<details>
<summary>Proof</summary>
To prove monotonicity, every covering of $E_2$ by a countable set of cubes 
is also a covering of $E_1$. 
For countable subadditivity, the main idea is to construct increasingly 
tight covers such that the countable union of 
these covers is still finitely tight. 
Assume the nontrivial case $\mu_*(E_j)<\infty$. 
For every $\epsilon>0$, we can construct for each $j$ a covering 
\[ 
    E_j\subset \bigcup_{k=1}^\infty R_{k, j}, \quad 
    \sum_{k=1}^\infty |R_{k, j}| \leq \mu_*(E_j) + \df{\epsilon}{2^j}
\] 
The increasingly tight bound ensures that 
\begin{align}
    \mu_*(E) 
    &\leq \sum_{j, k}|R_{k, j}| \leq \sum_{j=1}^\infty \mu_*(E_j) + \df \epsilon {2^j} 
    = \sum_{j=1}^\infty \mu_*(E_j)+\epsilon
\end{align}
</details>

:::{.proposition #openCoverInfimum name="equivalence with open cover infimum"}
Given $E\subset \R^n$, $\mu_*(E)=\inf \mu_*(\mca O)$, where $\inf$ is 
over all open sets $\mca O$ covering $E$. 
:::
<details>
<summary>Proof</summary>
$\mu_*(E)\leq \inf \mu_*(\mca O)$ holds by monotonicity. 
For the other direction, choose cubes $R_j$ covering $E$ 
with margin $\epsilon/2$, and for each cube choose open cube 
$O_j$ covering $R_j$ with margin $\epsilon/2^{j+1}$, then $(O_j)$ 
cover $E$ with margin $\epsilon$. 
</details>

Given a countable set $R_j$ of disjoint rectangles, it is 
intuitive (and easy to show that) 
\[ 
    \mu_*\bigsqcup_{j=1}^\infty R_j = \sum_{j=1}^\infty \mu_*(R_j)
\] 
This is our base case for establishing measurability later on. 

The following proposition is the main reason why we chose closed 
rectangles (instead of open, though they are effectively the same) 
as the basic measurable sets. 

:::{.proposition #finiteDistanceAdditivity name="additivity with finite distance"}
If $E=E_1\cup E_2$ and $d(E_1, E_2)>0$, then 
\[ 
    \mu_*(E) = \mu_*(E_1)+\mu_*(E_2) 
\] 
:::
<details>
<summary>Proof</summary>
By subadditivity, $\mu_*(E)\leq \mu_*(E_1)+\mu_*(E_2)$. 
To show the converse, select $0<\delta < d(E_1, E_2)$ and 
choose a cover $(Q_j)$ of $E$ by closed cubes with margin $\epsilon$. 
Subdivide $(Q_j)$ so that each has size less than $\delta$, so 
that each cube intersects at most one of $E_1, E_2$. Denote by 
$J_1, J_2$ the indices for which $Q_j$ intersects $E_1, E_2$, then 
$E_1, E_2$ are covered by $Q_{J_1}, Q_{J_2}$ respectively. 
</details>

:::{.corollary #almostDisjointAdditivity name="additivity of almost-disjoint rectangles"}
The exterior measure is additive on 
countable collections of almost-disjoint rectangles $R_j\in \mbb R^d$. 
:::
<details>
<summary>Proof</summary>
Give $\epsilon>0$, shrink rectangle $j$ by $\epsilon/2^j$ so they 
are closed sets with finite distance, then invoke additivity through 
proposition \@ref(prp:finiteDistanceAdditivity). 
</details>


:::{.proposition #rectangleMeasurable name="Carathéodory criteria for rectangles"}
Given a rectangle $\subset \R^n$, 
\[ 
    \mu_*(\forall E\subset \R^n) = \mu_*(E\cap R)+ \mu_*(E\cap R^c)
\] 
:::
<details>
<summary>Proof</summary>
To prove the nontrivial direction 
$\mu_*(E\cap R)+ \mu_*(E\cap R^c)\leq \mu_*(\forall E\subset \R^n)$, 
choose an $\epsilon$-cover $R_j$ of $E$, then 
rectang-ify $R_j$ into $R^1_j, R^2_j$ covering 
$E\cap R, E\cap R^c$ respectively and invoke corollary 
\@ref(cor:almostDisjointAdditivity). This shows that 
\[ 
    \mu_*(E\cap R)+ \mu_*(E\cap R^c)
    \leq \mu_*(\forall E\subset \R^n) + \epsilon, \quad \forall \epsilon>0 
\] 
</details>

<span style="color:green">
Boundaries to not always have nontrivial measures
(e.g. $\mbb Q\cap [0, 1]$). There are even 
boundaries of closed sets which have nontrivial measure 
(e.g. fat Cantor set). 
</span>



## Lebesgue measure, Borel regularity {#lebMeasure -}

:::{.definition name="Lebesgue measure"}
The set $\mca L\subset \R^n$ of Lebesgue measurable sets 
are the Carathéodory-measurable sets of the exterior measure: 
\[ 
    S\in \mca L \iff \mu_*(\forall E\subset \R^n) 
    = \mu_*(E\cap S)+\mu_*(E\cap S^c)
\] 
:::

Note that one direction in the Carathéodory criterion always holds 
by subadditivity: 
\[ 
    \mu_*(E) \leq \mu_*(E\cap B) + \mu_*(E\cap B^c)
\] 

:::{.proposition name="null sets are measurable"}
$\mu(E\subset \R^n)=0\implies E\in \mca L$. 
:::
<details>
<summary>Proof</summary>
To show the nontrivial direction, $\mu(E\cap B)\leq \mu(E)=0$, then 
$\mu(E\cap B^c) \leq \mu(E)$ by subadditivity. 
</details>

:::{.proposition name=#prp:nullDifferenceMeasurability}
If $\mu_*(A\Delta B) = 0$ for $\in \mca L$, 
then $A$ is measurable. 
:::
<details>
<summary>Proof</summary>
Without loss of generality assume $B\subset A$. 
We wish to show thenontrivial direction 
\begin{align}
    \mu_*(\forall E) 
    &\geq \mu_*(E\cap A) + \mu_*(E\cap A^c)  
\end{align}
The second term $\mu_*(E\cap A^c)\leq \mu_*(E\cap B^c)$ 
by subadditivity, and the first term 
\[ 
    \mu_*(E\cap A) \leq \mu_*(E\cap B) + \mu_*(E\cap (A-B)) 
    \leq \mu_*(E\cap B) + \mu_*(A-B)_{=0}
\] 
Then $\mu_*(E\cap A) + \mu_*(E\cap A^c)\leq 
    \mu_*(E\cap B) + \mu_*(E\cap B^c) = \mu_*(E)$ by $B$ measurable. 
</details>

:::{.definition name="Borel sets"}
The Borel set $\mca B\subset 2^{R^n}$ is the $\sigma$-algebra 
freely generated by rectangles. 
:::

:::{.theorem name="Borel sets are Lebesgue measurable"}
$\mca B\subset \mca L$. 
:::
_Proof:_ Proposition \@ref(prp:rectangleMeasurable) states that rectangles 
are measurable; invoking the machinery we built in the section 
on the [Carathéodory theorem](#caratheodory) we obtain that 
the elements of the $\sigma$-algebra freely generated by rectangles (Borel subsets) 
are measurable. 

### A non-measurable set {-}

Write $x\sim y$ if $x-y$ is rational and let $\mca E_\alpha$ 
be the equivalence class of $\alpha$. Then 
$[0, 1]=\bigcup \mca E_\alpha$ and construct 
$\mca N$ by choosing one element $x_\alpha$ from 
each $\mca E_\alpha$. 

:::{.proposition} 
$\mca N$ is not measurable.
:::
_Proof:_ Assume $\mca N$ measurable and let 
$\{r_k\}_{k=1}^\infty$ be an enumeration of all rationals 
in $[-1, 1]$ and consider $\mca N_k = \mca N + r_k$. Then 
all $\{\mca N_k\}$ are disjoint. Note that 
\[ 
    [0, 1] \subset \bigsqcup_{k=1}^\infty \mca N_k \subset [-1, 2]
\] 
Assuming measurability (contradiction!), we have 
\[ 
    1\leq \sum_{k=1}^\infty \mu(\mca N_k) \leq 3 
\] 
Every term in the sum is equal, but there is no real number 
which satisfies the construction above; contradiction: 
there cannot be a disjoint-additive function on the disjoint 
countable collection $\{\mca N_k\}$. 

### Approximation of measurable sets {-}

We have seen that the exterior measure is equivalent to open cover infinum 
\@ref(prp:openCoverInfimum). We also have 

:::{.proposition #measurableCompactSupremum name="compact subset supremum"}
If $A$ is Lebesgue measurable, then 
\[ 
    \mu(A) = \sup_{K\subset A\text{ compact}} \mu(K)
\] 
:::
<details>
<summary>Proof</summary>
The trivial direction is $\sup_{K\subset A\text{ compact}} \mu(K) \leq \mu(A)$. 
We wish to show, $\forall \epsilon>0$, that 
\[ 
    \exists K\subset A\text{ compact}: \mu(K) + \epsilon \geq \mu(A)
\] 

```{r echo=FALSE, fig.align='center', out.width='80%', fig.cap="$A$ bounded"}
  knitr::include_graphics("images/compactApprox.jpeg") 
```

1. First suppose $A$ bounded; consider compact $F\supset A$, 
    then there is an open set $G\supset F-A$ which $\epsilon$-approximates
    $F-A$, then $K=A\cap O^c$ is a compact sub-$\epsilon$ subset approximation 
    of $A$. 
    - $K$ must be compact, else $F\subset K\cup O$ will not be compact. 
2. $A$ unbounded: we can construct for each $j\in \mbb N$ 
    an $\epsilon$-approximation of $A_j = A\cap \overline{B_j(0)}$ 
    with $A_j\to A\implies \mu(A_j)\to \mu(A)$. 
</details>

:::{.theorem #openCoverMeasureApprox name="measurability by open cover approximation"}
$A\subset \R^n$ is Lebesgue measurable iff $\forall \epsilon>0$, 
there exists $G\supset A$ such that 
\[ 
    \mu_*(G - A) < \epsilon 
\] 
:::
<details>
<summary>Proof</summary>
Given $A$ measurable, the result follows from open cover 
infimum proposition \@ref(prp:openCoverInfimum). 
Conversely, suppose $A\subset \R^n$ satisfies the conditions 
in the theorem, then choose an $\epsilon$-cover $G\supset A$. 
Note that 
\[ 
    E\cap A^c = E\cap G^c + E\cap (G-A)
\] 
Directly verify the Carathéodory criterion: we use the 
measurability of $G$ and subadditivity 
\begin{align}
    \mu_*(E\cap A) + \mu_*(E\cap A^c) 
    &= \mu_*(E\cap A) + \mu_*(E\cap A^c)  \\ 
    &\leq \mu_*(E\cap G) + \mu_*(E\cap G^c) + \mu_*(E\cap (G-A)) \\ 
    &\leq \mu_*(E\cap G) + \mu_*(E\cap G^c) + \mu_*(G-A)_{< \epsilon} \\ 
    &< \mu_*(E\cap G) + \mu_*(E\cap G^c) + \epsilon 
    = \mu_*(E\cap G) + \epsilon
\end{align}
</details>

:::{.theorem #squeezeMeasurable name="inner and outer regularity"}
$A\subset \R^n$ is Lebesgue measurable iff $\forall \epsilon>0$, 
there exists open $G$, closed $F$, with $F\subset A\subset G$ such that 
$\mu_*(G - F) < \epsilon$. 
:::
_Proof:_ If $A$ satisfies the theorem conditions, then 
$\mu_*(G - A) \leq \mu_*(G - F)<\epsilon$ so $A$ is measurable 
by theorem \@ref(thm:openCoverMeasureApprox). 
Conversely, given $A$ measurable, by theorem \@ref(thm:openCoverMeasureApprox) 
choose $\epsilon/2$-covers of both $A$ and $A^c$. 

:::{.theorem #borelApprox name="measurability by Borel approximation"}
$A\subset \R^n$ is Lebesgue measurable iff there 
exists Borel sets $G, F$ with $F\subset A\subset G$ such that 
\[ 
    \mu(G - A) = \mu(A - F) = 0
\] 
:::
_Proof:_ By theorem \@ref(thm:squeezeMeasurable), construct for each 
$k\in \mbb N$ sets $G_k, F_k$ which $1/k$-squeeze $G$, then 
$G=\bigcap G_k, F=\bigcup F_k$ proves the theorem. 